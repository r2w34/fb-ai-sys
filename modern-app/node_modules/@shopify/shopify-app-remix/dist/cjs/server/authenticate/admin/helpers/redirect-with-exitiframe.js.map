{"version":3,"file":"redirect-with-exitiframe.js","sources":["../../../../../../../src/server/authenticate/admin/helpers/redirect-with-exitiframe.ts"],"sourcesContent":["import {redirect} from '@remix-run/server-runtime';\n\nimport type {BasicParams} from '../../../types';\n\nexport function redirectWithExitIframe(\n  params: BasicParams,\n  request: Request,\n  shop: string,\n): never {\n  const {api, config} = params;\n  const url = new URL(request.url);\n\n  const queryParams = url.searchParams;\n\n  const host = api.utils.sanitizeHost(queryParams.get('host')!);\n\n  queryParams.set('shop', shop);\n\n  let destination = `${config.auth.path}?shop=${shop}`;\n\n  if (host) {\n    queryParams.set('host', host);\n    destination = `${destination}&host=${host}`;\n  }\n  queryParams.set('exitIframe', destination);\n\n  throw redirect(`${config.auth.exitIframePath}?${queryParams.toString()}`);\n}\n"],"names":["redirect"],"mappings":";;;;SAIgB,sBAAsB,CACpC,MAAmB,EACnB,OAAgB,EAChB,IAAY,EAAA;AAEZ,IAAA,MAAM,EAAC,GAAG,EAAE,MAAM,EAAC,GAAG,MAAM;IAC5B,MAAM,GAAG,GAAG,IAAI,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC;AAEhC,IAAA,MAAM,WAAW,GAAG,GAAG,CAAC,YAAY;AAEpC,IAAA,MAAM,IAAI,GAAG,GAAG,CAAC,KAAK,CAAC,YAAY,CAAC,WAAW,CAAC,GAAG,CAAC,MAAM,CAAE,CAAC;AAE7D,IAAA,WAAW,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,CAAC;IAE7B,IAAI,WAAW,GAAG,CAAA,EAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAA,MAAA,EAAS,IAAI,CAAA,CAAE;IAEpD,IAAI,IAAI,EAAE;AACR,QAAA,WAAW,CAAC,GAAG,CAAC,MAAM,EAAE,IAAI,CAAC;AAC7B,QAAA,WAAW,GAAG,CAAA,EAAG,WAAW,CAAA,MAAA,EAAS,IAAI,EAAE;IAC7C;AACA,IAAA,WAAW,CAAC,GAAG,CAAC,YAAY,EAAE,WAAW,CAAC;AAE1C,IAAA,MAAMA,sBAAQ,CAAC,CAAA,EAAG,MAAM,CAAC,IAAI,CAAC,cAAc,CAAA,CAAA,EAAI,WAAW,CAAC,QAAQ,EAAE,CAAA,CAAE,CAAC;AAC3E;;;;"}